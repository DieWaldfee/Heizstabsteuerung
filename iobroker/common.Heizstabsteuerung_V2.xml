<xml xmlns="https://developers.google.com/blockly/xml">
  <variables>
    <variable type="timeout" id="Lüfterabschaltung">Lüfterabschaltung</variable>
  </variables>
  <block type="create" id="H!/UJ?knt9[PW9:I@b]5" x="188" y="-337">
    <field name="NAME">Heizung_Heizstabsteuerung_Reboot</field>
    <value name="VALUE">
      <block type="logic_boolean" id="`|2u^[Iah[|h?.M*G=nS">
        <field name="BOOL">FALSE</field>
      </block>
    </value>
    <value name="COMMON">
      <block type="text" id="HM`1GGah6$;3ZvV?ZPT*">
        <field name="TEXT">{"type": "boolean", "role": "state","read": true, "write": true}</field>
      </block>
    </value>
    <next>
      <block type="create" id="LW`oCh-rc;1Wg.{0W$[Y">
        <field name="NAME">Heizung_Thermoabschaltung</field>
        <value name="VALUE">
          <block type="logic_boolean" id="aLTkgmf^m:/N:rXRw#^^">
            <field name="BOOL">FALSE</field>
          </block>
        </value>
        <value name="COMMON">
          <block type="text" id="WHRp.]AriK]TJYsfFb!6">
            <field name="TEXT">{"type": "boolean", "role": "state","read": true, "write": true}</field>
          </block>
        </value>
        <next>
          <block type="create" id="yHA#0h/BQV9Ol-USMpp2">
            <field name="NAME">Heizung_Notabschaltung</field>
            <value name="VALUE">
              <block type="logic_boolean" id="k0K%KGNON(P@lV@2[+g=">
                <field name="BOOL">FALSE</field>
              </block>
            </value>
            <value name="COMMON">
              <block type="text" id="Rv27,*aOAmP0y841`Ug{">
                <field name="TEXT">{"type": "boolean", "role": "state","read": true, "write": true}</field>
              </block>
            </value>
            <next>
              <block type="create" id="IT4,qgPYrO#XB1)m+A$N">
                <field name="NAME">Heizung_Heizstabstatus</field>
                <value name="VALUE">
                  <block type="logic_boolean" id="hIgWpg22}0B+Kk?9851?">
                    <field name="BOOL">FALSE</field>
                  </block>
                </value>
                <value name="COMMON">
                  <block type="text" id="_l:/JP8sjXc?-EU8$pob">
                    <field name="TEXT">{"type": "boolean", "role": "state","read": true, "write": true}</field>
                  </block>
                </value>
                <next>
                  <block type="create" id="ZP)u9:V%KrB:6oEQUmJM">
                    <field name="NAME">Heizung_Steuerungsabschaltung</field>
                    <value name="VALUE">
                      <block type="logic_boolean" id="s5m(KDzC5U-w4SimaoGZ">
                        <field name="BOOL">FALSE</field>
                      </block>
                    </value>
                    <value name="COMMON">
                      <block type="text" id="ZdTs7M76$2p:LWFmItV!">
                        <field name="TEXT">{"type": "boolean", "role": "state","read": true, "write": true}</field>
                      </block>
                    </value>
                    <next>
                      <block type="create" id="vmQ_.na}@8@$xKI_*mo5">
                        <field name="NAME">Heizung_Schaltstufe_1</field>
                        <value name="VALUE">
                          <block type="logic_boolean" id="IA%Aqb~8`TGRlX=Kz~e7">
                            <field name="BOOL">FALSE</field>
                          </block>
                        </value>
                        <value name="COMMON">
                          <block type="text" id="GW{KS(qm_B5fYmzr{s4J">
                            <field name="TEXT">{"type": "boolean", "role": "state","read": true, "write": true}</field>
                          </block>
                        </value>
                        <next>
                          <block type="create" id="HlWrLSNB_d/2AIu-tLP)">
                            <field name="NAME">Heizung_Schaltstufe_2</field>
                            <value name="VALUE">
                              <block type="logic_boolean" id="v7Z;T%L:XVDBM)e/cQ?[">
                                <field name="BOOL">FALSE</field>
                              </block>
                            </value>
                            <value name="COMMON">
                              <block type="text" id="c`Rb5?$5fDgETYXI]rbj">
                                <field name="TEXT">{"type": "boolean", "role": "state","read": true, "write": true}</field>
                              </block>
                            </value>
                            <next>
                              <block type="create" id="(.Q8kFhA2RRz2p4LjjoM">
                                <field name="NAME">Heizung_Speichertemperatur_Top1</field>
                                <value name="VALUE">
                                  <block type="math_number" id="$%r~6]!9bw!{=@,L.FoD">
                                    <field name="NUM">0</field>
                                  </block>
                                </value>
                                <value name="COMMON">
                                  <block type="text" id="PCA.HHf?,g%-2B:7:jj/">
                                    <field name="TEXT">{"type": "number", "unit": "°C", "role": "value", "read": true, "write": true}</field>
                                  </block>
                                </value>
                                <next>
                                  <block type="create" id="/9^V.8UKxl3A=ug?i5g?">
                                    <field name="NAME">Heizung_Speichertemperatur_Top2</field>
                                    <value name="VALUE">
                                      <block type="math_number" id="B6~9~o?Q4qzSP!iRU!GR">
                                        <field name="NUM">0</field>
                                      </block>
                                    </value>
                                    <value name="COMMON">
                                      <block type="text" id="Z{!/*@uO}HGdUc/t)?!q">
                                        <field name="TEXT">{"type": "number", "unit": "°C", "role": "value", "read": true, "write": true}</field>
                                      </block>
                                    </value>
                                    <next>
                                      <block type="create" id="/==KIR(PT$k.#c+T:fYY">
                                        <field name="NAME">Heizung_Speichertemperatur_Max</field>
                                        <value name="VALUE">
                                          <block type="math_number" id="A1xUjotUU-x-5?GPPR4s">
                                            <field name="NUM">0</field>
                                          </block>
                                        </value>
                                        <value name="COMMON">
                                          <block type="text" id="4t_2WXe}gH^ZjfguSOor">
                                            <field name="TEXT">{"type": "number", "unit": "°C", "role": "value", "read": true, "write": true}</field>
                                          </block>
                                        </value>
                                        <next>
                                          <block type="comment" id="V=T54F_|1XGtdRBsB`r_">
                                            <field name="COMMENT">Einschaltgrenze = ab wieviel Ampere = ein?</field>
                                            <next>
                                              <block type="update" id="].+0t|/M)T{j6V|p}O(E">
                                                <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                                                <field name="OID">javascript.0.Heizung_Steuerungsabschaltung</field>
                                                <field name="WITH_DELAY">FALSE</field>
                                                <value name="VALUE">
                                                  <block type="logic_negate" id="VGvQiKgwwVdmL;cHbiSJ">
                                                    <value name="BOOL">
                                                      <block type="get_value" id="3Z#ohz${|t:#@kAvRQHL">
                                                        <field name="ATTR">val</field>
                                                        <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.status</field>
                                                      </block>
                                                    </value>
                                                  </block>
                                                </value>
                                                <next>
                                                  <block type="control" id="nbAL7M0g5Lthb5i?kre[">
                                                    <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                                                    <field name="OID">javascript.0.Heizung_Schaltstufe_1</field>
                                                    <field name="WITH_DELAY">FALSE</field>
                                                    <value name="VALUE">
                                                      <block type="logic_boolean" id="P:.U_i|BTZxE}o}]z}02">
                                                        <field name="BOOL">FALSE</field>
                                                      </block>
                                                    </value>
                                                    <next>
                                                      <block type="control" id="BJD=Q%s]5p5Ajkpe|+jq">
                                                        <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                                                        <field name="OID">javascript.0.Heizung_Schaltstufe_2</field>
                                                        <field name="WITH_DELAY">FALSE</field>
                                                        <value name="VALUE">
                                                          <block type="logic_boolean" id="tK+$.US!FZF]cssgbD}1">
                                                            <field name="BOOL">FALSE</field>
                                                          </block>
                                                        </value>
                                                        <next>
                                                          <block type="controls_if" id="xl#GdTw?K*YdBWws93JH">
                                                            <value name="IF0">
                                                              <block type="logic_compare" id="]Y0ouKxYMQ8}y]d|@=FC">
                                                                <field name="OP">EQ</field>
                                                                <value name="A">
                                                                  <block type="get_value" id="V5jJo+WnUhW?3GdWA@S-">
                                                                    <field name="ATTR">val</field>
                                                                    <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.command</field>
                                                                  </block>
                                                                </value>
                                                                <value name="B">
                                                                  <block type="text" id=":gd]-dt/Qeo/39|xa2~!">
                                                                    <field name="TEXT">L123 aus</field>
                                                                  </block>
                                                                </value>
                                                              </block>
                                                            </value>
                                                            <statement name="DO0">
                                                              <block type="control" id="*I8xy+.T0Xnve2.HdK-s">
                                                                <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                                                                <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.command</field>
                                                                <field name="WITH_DELAY">FALSE</field>
                                                                <value name="VALUE">
                                                                  <block type="text" id="kfovZN+)|OsM~L~eSg=k">
                                                                    <field name="TEXT">L3 aus</field>
                                                                  </block>
                                                                </value>
                                                                <next>
                                                                  <block type="timeouts_wait" id="=K*]b2/tJCvaJo.yu3i4">
                                                                    <field name="DELAY">3</field>
                                                                    <field name="UNIT">sec</field>
                                                                  </block>
                                                                </next>
                                                              </block>
                                                            </statement>
                                                            <next>
                                                              <block type="control" id="6w(.p.{aS(rNk:fZ.fCH">
                                                                <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                                                                <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.command</field>
                                                                <field name="WITH_DELAY">FALSE</field>
                                                                <value name="VALUE">
                                                                  <block type="text" id="Tq={7H/gTV:5Dlh!E:gs">
                                                                    <field name="TEXT">L123 aus</field>
                                                                  </block>
                                                                </value>
                                                                <next>
                                                                  <block type="timeouts_wait" id="~IwrlrAuMkQ$Mk}hkT:,">
                                                                    <field name="DELAY">3</field>
                                                                    <field name="UNIT">sec</field>
                                                                    <next>
                                                                      <block type="controls_if" id="k.K3pdJnAh2KUDu2]{7d">
                                                                        <value name="IF0">
                                                                          <block type="logic_compare" id="5iarZz;sdlY%k42hZ()D">
                                                                            <field name="OP">NEQ</field>
                                                                            <value name="A">
                                                                              <block type="text" id="T4@3B2~yq@V9hUTrsr(6">
                                                                                <field name="TEXT">Phase 1,2 und 3 ausgeschaltet</field>
                                                                              </block>
                                                                            </value>
                                                                            <value name="B">
                                                                              <block type="get_value" id="/r^a([Gl+GX`YtJp4S(T">
                                                                                <field name="ATTR">val</field>
                                                                                <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.ac</field>
                                                                              </block>
                                                                            </value>
                                                                          </block>
                                                                        </value>
                                                                        <statement name="DO0">
                                                                          <block type="comment" id="s{b`4iL:P:G.H09jh}|U">
                                                                            <field name="COMMENT">Fehler, da Kommando nicht angekommen</field>
                                                                            <next>
                                                                              <block type="debug" id="Rtt%}F`/H+p,LEA7568:">
                                                                                <field name="Severity">error</field>
                                                                                <value name="TEXT">
                                                                                  <shadow type="text" id="s~JE0Ytj!;AsUa`.^w}~">
                                                                                    <field name="TEXT">Fehler beim Skript-Boot: Antwort nicht angekommen.</field>
                                                                                  </shadow>
                                                                                </value>
                                                                                <next>
                                                                                  <block type="control" id="S?@(qoOJgR[A*fc3*|6v" disabled="true">
                                                                                    <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                                                                                    <field name="OID">javascript.0.scriptEnabled.common.Heizstabsteuerung_V2</field>
                                                                                    <field name="WITH_DELAY">FALSE</field>
                                                                                    <value name="VALUE">
                                                                                      <block type="logic_boolean" id="b%-x:[B79xE4epr5srkY">
                                                                                        <field name="BOOL">FALSE</field>
                                                                                      </block>
                                                                                    </value>
                                                                                  </block>
                                                                                </next>
                                                                              </block>
                                                                            </next>
                                                                          </block>
                                                                        </statement>
                                                                        <next>
                                                                          <block type="comment" id="M8.EM3UY1lxE2/qbn,Lb">
                                                                            <field name="COMMENT">Heizstab schalten bei Überproduktion</field>
                                                                            <next>
                                                                              <block type="on" id="fm_IB?M+_a+CkGcL_:(3">
                                                                                <field name="OID">sonnen.0.status.gridFeedIn</field>
                                                                                <field name="CONDITION">any</field>
                                                                                <field name="ACK_CONDITION">true</field>
                                                                                <statement name="STATEMENT">
                                                                                  <block type="controls_if" id="Rt-nV~0uKZ@!Nm;h{(%I">
                                                                                    <mutation else="1"></mutation>
                                                                                    <value name="IF0">
                                                                                      <block type="logic_compare" id="KaK:|%2|QFRE.hZQsch5">
                                                                                        <field name="OP">GT</field>
                                                                                        <value name="A">
                                                                                          <block type="on_source" id="R}s|z;o-#/e{i(2v55Sg">
                                                                                            <field name="ATTR">state.val</field>
                                                                                          </block>
                                                                                        </value>
                                                                                        <value name="B">
                                                                                          <block type="math_number" id="7H/bU8Iq/fjIa;ah[2DR">
                                                                                            <field name="NUM">3800</field>
                                                                                          </block>
                                                                                        </value>
                                                                                      </block>
                                                                                    </value>
                                                                                    <statement name="DO0">
                                                                                      <block type="comment" id="tpS^9`R!H^.|~F|sk-44">
                                                                                        <field name="COMMENT">Leistung ausreichent zur Phasenschatung</field>
                                                                                        <next>
                                                                                          <block type="comment" id="v7`dh%Zj)=]|C}2z/t|_">
                                                                                            <field name="COMMENT">Normalbetrieb -&gt; Phase 1 &amp; 2  ggf. auch 3 können geschaltet werden</field>
                                                                                            <next>
                                                                                              <block type="controls_if" id="^h^NZ+fiM:,*0G+_^OX[">
                                                                                                <value name="IF0">
                                                                                                  <block type="logic_negate" id="qQ,31_H{usYxj$)!rFoY">
                                                                                                    <value name="BOOL">
                                                                                                      <block type="get_value" id="WfPY(5sM#/#}yYQ%4R;t">
                                                                                                        <field name="ATTR">val</field>
                                                                                                        <field name="OID">javascript.0.Heizung_Thermoabschaltung</field>
                                                                                                      </block>
                                                                                                    </value>
                                                                                                  </block>
                                                                                                </value>
                                                                                                <statement name="DO0">
                                                                                                  <block type="procedures_callnoreturn" id="6z*E64/Jyx,_~|9s}i/o">
                                                                                                    <mutation name="StartUpHeizstab"></mutation>
                                                                                                    <next>
                                                                                                      <block type="debug" id="6a]UK2(oUNL%H_Z4n*#5" disabled="true">
                                                                                                        <field name="Severity">info</field>
                                                                                                        <value name="TEXT">
                                                                                                          <shadow type="text" id="VVJy2d$^x4LH$+8X#%tR">
                                                                                                            <field name="TEXT">StartUpHeizstab ausgeführt</field>
                                                                                                          </shadow>
                                                                                                        </value>
                                                                                                        <next>
                                                                                                          <block type="timeouts_wait" id="33s.D/R$6;bI,30i8cr6">
                                                                                                            <field name="DELAY">3</field>
                                                                                                            <field name="UNIT">sec</field>
                                                                                                          </block>
                                                                                                        </next>
                                                                                                      </block>
                                                                                                    </next>
                                                                                                  </block>
                                                                                                </statement>
                                                                                              </block>
                                                                                            </next>
                                                                                          </block>
                                                                                        </next>
                                                                                      </block>
                                                                                    </statement>
                                                                                    <statement name="ELSE">
                                                                                      <block type="controls_if" id="#@njXgYQ{`_EtSV,=!x!">
                                                                                        <mutation elseif="1"></mutation>
                                                                                        <value name="IF0">
                                                                                          <block type="logic_compare" id="NU=5H:8i$mq3wf?}_N~?">
                                                                                            <field name="OP">LTE</field>
                                                                                            <value name="A">
                                                                                              <block type="on_source" id="X3_-`Eja`DpKJcZ6ecAB">
                                                                                                <field name="ATTR">state.val</field>
                                                                                              </block>
                                                                                            </value>
                                                                                            <value name="B">
                                                                                              <block type="math_number" id=":)GoEBo!MS7N8k]M/jk(">
                                                                                                <field name="NUM">-200</field>
                                                                                              </block>
                                                                                            </value>
                                                                                          </block>
                                                                                        </value>
                                                                                        <statement name="DO0">
                                                                                          <block type="comment" id="|ZH.jmim%j9qfm|j(O0]">
                                                                                            <field name="COMMENT">Abschaltung, da Netzbezug &gt; 200W...</field>
                                                                                            <next>
                                                                                              <block type="procedures_callnoreturn" id="wbCd%!y?09fO,FA4kg:a">
                                                                                                <mutation name="ShutDownHeizstab"></mutation>
                                                                                                <next>
                                                                                                  <block type="debug" id="6%DaBDJhz,I]U$N|A6P[" disabled="true">
                                                                                                    <field name="Severity">info</field>
                                                                                                    <value name="TEXT">
                                                                                                      <shadow type="text" id="u^x$*)c@i{BZ?RuU4Aoy">
                                                                                                        <field name="TEXT">ShutDownHeizstab ausgeführt</field>
                                                                                                      </shadow>
                                                                                                    </value>
                                                                                                    <next>
                                                                                                      <block type="timeouts_wait" id="541e:ngJbim3p*m*fo]N">
                                                                                                        <field name="DELAY">3</field>
                                                                                                        <field name="UNIT">sec</field>
                                                                                                      </block>
                                                                                                    </next>
                                                                                                  </block>
                                                                                                </next>
                                                                                              </block>
                                                                                            </next>
                                                                                          </block>
                                                                                        </statement>
                                                                                        <value name="IF1">
                                                                                          <block type="logic_compare" id="3cs$R.j-!^1Y|RgFx;KO">
                                                                                            <field name="OP">GT</field>
                                                                                            <value name="A">
                                                                                              <block type="get_value" id="-?kVw@^)_R){7CFw(F.V">
                                                                                                <field name="ATTR">val</field>
                                                                                                <field name="OID">sonnen.0.status.pacTotal</field>
                                                                                              </block>
                                                                                            </value>
                                                                                            <value name="B">
                                                                                              <block type="math_number" id="wqC/!Za:`p-b;wI%fR`0">
                                                                                                <field name="NUM">50</field>
                                                                                              </block>
                                                                                            </value>
                                                                                          </block>
                                                                                        </value>
                                                                                        <statement name="DO1">
                                                                                          <block type="comment" id=";}`T=s;uh-}D#-F!tf^z">
                                                                                            <field name="COMMENT">Abschaltung, da Speisung aus der Batterie...</field>
                                                                                            <next>
                                                                                              <block type="procedures_callnoreturn" id="ZCzvy-Bfl*vU^(a0+mHn">
                                                                                                <mutation name="ShutDownHeizstab"></mutation>
                                                                                                <next>
                                                                                                  <block type="debug" id="v_jecoG[FC`TQNw^,V@G" disabled="true">
                                                                                                    <field name="Severity">info</field>
                                                                                                    <value name="TEXT">
                                                                                                      <shadow type="text" id="@bq+_.B3EjZduZ/Jemqm">
                                                                                                        <field name="TEXT">ShutDownHeizstab ausgeführt</field>
                                                                                                      </shadow>
                                                                                                    </value>
                                                                                                    <next>
                                                                                                      <block type="timeouts_wait" id="V0%d9TE:_#X{xGr]=Av1">
                                                                                                        <field name="DELAY">3</field>
                                                                                                        <field name="UNIT">sec</field>
                                                                                                      </block>
                                                                                                    </next>
                                                                                                  </block>
                                                                                                </next>
                                                                                              </block>
                                                                                            </next>
                                                                                          </block>
                                                                                        </statement>
                                                                                      </block>
                                                                                    </statement>
                                                                                  </block>
                                                                                </statement>
                                                                              </block>
                                                                            </next>
                                                                          </block>
                                                                        </next>
                                                                      </block>
                                                                    </next>
                                                                  </block>
                                                                </next>
                                                              </block>
                                                            </next>
                                                          </block>
                                                        </next>
                                                      </block>
                                                    </next>
                                                  </block>
                                                </next>
                                              </block>
                                            </next>
                                          </block>
                                        </next>
                                      </block>
                                    </next>
                                  </block>
                                </next>
                              </block>
                            </next>
                          </block>
                        </next>
                      </block>
                    </next>
                  </block>
                </next>
              </block>
            </next>
          </block>
        </next>
      </block>
    </next>
  </block>
  <block type="procedures_defnoreturn" id="Xo5S)|%^m88idvXgC|pM" x="1188" y="162">
    <field name="NAME">StartUpHeizstab</field>
    <comment pinned="false" h="80" w="160">Beschreibe diese Funktion …</comment>
    <statement name="STACK">
      <block type="comment" id="z{~!]Kz#Xtr(+n`j40v.">
        <field name="COMMENT">Funktion zur stufenweisen Zuschaltung des Heizstabs</field>
        <next>
          <block type="controls_if" id="9Qm7]~Q=?=+KOe,8FtNV">
            <mutation else="1"></mutation>
            <value name="IF0">
              <block type="logic_negate" id="=Kie78GpMoJORq==qe7+">
                <value name="BOOL">
                  <block type="get_value" id="iWqub6:RjY9Zom72s=uo">
                    <field name="ATTR">val</field>
                    <field name="OID">javascript.0.Heizung_Schaltstufe_1</field>
                  </block>
                </value>
              </block>
            </value>
            <statement name="DO0">
              <block type="comment" id="Aag0tS9);,48=3|$,qUj">
                <field name="COMMENT">Schaltstufe 1 nicht geschalten =&gt; Phase 1&amp;2 anschalten</field>
                <next>
                  <block type="update" id="B25e9Bd3IE;vS4+~,oFO">
                    <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                    <field name="OID">javascript.0.Heizung_Schaltstufe_1</field>
                    <field name="WITH_DELAY">FALSE</field>
                    <value name="VALUE">
                      <block type="logic_boolean" id="nX^Z=k9$IZjw!^O,v6y4">
                        <field name="BOOL">TRUE</field>
                      </block>
                    </value>
                    <next>
                      <block type="comment" id="?7~r/u{uZy1rBfXCw;XL">
                        <field name="COMMENT">Phase 1 &amp; 2 an</field>
                        <next>
                          <block type="control" id="RRFV,k1])FhO2m%psJ^q">
                            <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                            <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.command</field>
                            <field name="WITH_DELAY">FALSE</field>
                            <value name="VALUE">
                              <block type="text" id="vl:j*(j1[FWk_#;L)8OD">
                                <field name="TEXT">L12 ein</field>
                              </block>
                            </value>
                            <next>
                              <block type="debug" id="5GObUV.QU;N3l{;VC,oB" disabled="true">
                                <field name="Severity">info</field>
                                <value name="TEXT">
                                  <shadow type="text" id="G7.=lKJpXnr0_0oQ14Ef">
                                    <field name="TEXT">Phase 1 &amp; 2 geschaltet</field>
                                  </shadow>
                                </value>
                                <next>
                                  <block type="timeouts_wait" id="XX:|}7@^3[%M?p3,6PNY">
                                    <field name="DELAY">2</field>
                                    <field name="UNIT">sec</field>
                                    <next>
                                      <block type="comment" id="8PxJ2a_B7G?Z|pkjIpFV">
                                        <field name="COMMENT">Lüfter an</field>
                                        <next>
                                          <block type="control" id=":}7}~v=2ES:1vXTu?1Ei">
                                            <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                                            <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.command</field>
                                            <field name="WITH_DELAY">FALSE</field>
                                            <value name="VALUE">
                                              <block type="text" id="nm;E;!]+~IC+cG3|MwHq">
                                                <field name="TEXT">Fan ein</field>
                                              </block>
                                            </value>
                                          </block>
                                        </next>
                                      </block>
                                    </next>
                                  </block>
                                </next>
                              </block>
                            </next>
                          </block>
                        </next>
                      </block>
                    </next>
                  </block>
                </next>
              </block>
            </statement>
            <statement name="ELSE">
              <block type="comment" id="3+v!m!46LI)ggQHF{RX#">
                <field name="COMMENT">Phase 1&amp;2 sind schon zugeschalten - 2 Stufe kann geschalten werden</field>
                <next>
                  <block type="controls_if" id="RbVMf@S*%xh50@uSFavB">
                    <value name="IF0">
                      <block type="logic_negate" id="4/Wt4],)hN(vYWVIluq$">
                        <value name="BOOL">
                          <block type="get_value" id="#-pwg.KUN]C8~_UEx]%;">
                            <field name="ATTR">val</field>
                            <field name="OID">javascript.0.Heizung_Schaltstufe_2</field>
                          </block>
                        </value>
                      </block>
                    </value>
                    <statement name="DO0">
                      <block type="comment" id="INV2;hG.f^ci[#`N%m[!">
                        <field name="COMMENT">Schaltstufe 2 nicht geschalten =&gt; Phase 3 anschalten</field>
                        <next>
                          <block type="update" id="HiImT5;)$@VPEO6Jc!9~">
                            <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                            <field name="OID">javascript.0.Heizung_Schaltstufe_2</field>
                            <field name="WITH_DELAY">FALSE</field>
                            <value name="VALUE">
                              <block type="logic_boolean" id="67N7__J;d,eP%b%Xu]ie">
                                <field name="BOOL">TRUE</field>
                              </block>
                            </value>
                            <next>
                              <block type="comment" id="r-Jp2lLY/k+MX3XGor4v">
                                <field name="COMMENT">Vollastschaltung durchführen: Phase 3 an</field>
                                <next>
                                  <block type="control" id="yZ[p_jEt^r0Ox:%t^|t%">
                                    <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                                    <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.command</field>
                                    <field name="WITH_DELAY">FALSE</field>
                                    <value name="VALUE">
                                      <block type="text" id="BuR|@zoaAe[{eC6`O^=r">
                                        <field name="TEXT">L3 ein</field>
                                      </block>
                                    </value>
                                    <next>
                                      <block type="debug" id="3H:Kj|sY5A3fOR@WnLXM" disabled="true">
                                        <field name="Severity">info</field>
                                        <value name="TEXT">
                                          <shadow type="text" id="6EHA,uZ(v5k0e`Yr(-bz">
                                            <field name="TEXT">Phase 3 geschaltet</field>
                                          </shadow>
                                        </value>
                                      </block>
                                    </next>
                                  </block>
                                </next>
                              </block>
                            </next>
                          </block>
                        </next>
                      </block>
                    </statement>
                  </block>
                </next>
              </block>
            </statement>
          </block>
        </next>
      </block>
    </statement>
  </block>
  <block type="procedures_defnoreturn" id="!VNyQi(gESkn`r|Fyo!:" x="2187" y="162">
    <field name="NAME">ShutDownHeizstab</field>
    <comment pinned="false" h="80" w="160">Beschreibe diese Funktion …</comment>
    <statement name="STACK">
      <block type="comment" id="|YJ:,7Bz*%e-l6UX{U%E">
        <field name="COMMENT">Funktion zur stufenweisen Abschaltung des Heizstabs</field>
        <next>
          <block type="controls_if" id="2xS/P?q,e|OnM%FIhS+o">
            <mutation else="1"></mutation>
            <value name="IF0">
              <block type="get_value" id="wT.^/a{WJe[oojrX@?f$">
                <field name="ATTR">val</field>
                <field name="OID">javascript.0.Heizung_Schaltstufe_2</field>
              </block>
            </value>
            <statement name="DO0">
              <block type="comment" id="+t*B:U*h*z8XkR|WA.@3">
                <field name="COMMENT">Phase 1,2&amp;3 sind schon zugeschalten - 2. Stufe abschalten</field>
                <next>
                  <block type="update" id="`K!@G9k,/O$Sbu/x=0b^">
                    <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                    <field name="OID">javascript.0.Heizung_Schaltstufe_2</field>
                    <field name="WITH_DELAY">FALSE</field>
                    <value name="VALUE">
                      <block type="logic_boolean" id="=c?(gww5DE~w{z-^2b|}">
                        <field name="BOOL">FALSE</field>
                      </block>
                    </value>
                    <next>
                      <block type="comment" id="=vGMJ_/2akgmOmoz-RwJ">
                        <field name="COMMENT">Phase 3 aus</field>
                        <next>
                          <block type="control" id="KL4=uZ{RX{JZ9:mVn2:H">
                            <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                            <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.command</field>
                            <field name="WITH_DELAY">FALSE</field>
                            <value name="VALUE">
                              <block type="text" id="7+!ss,?U#3gF7.F5%zCP">
                                <field name="TEXT">L3 aus</field>
                              </block>
                            </value>
                            <next>
                              <block type="debug" id="13k]kh$#mS`q5BKl4VUE" disabled="true">
                                <field name="Severity">info</field>
                                <value name="TEXT">
                                  <shadow type="text" id="`B$}D5a.hP27,HagST{u">
                                    <field name="TEXT">Phase 3 abgeschaltet</field>
                                  </shadow>
                                </value>
                              </block>
                            </next>
                          </block>
                        </next>
                      </block>
                    </next>
                  </block>
                </next>
              </block>
            </statement>
            <statement name="ELSE">
              <block type="controls_if" id="#:diFgr)7plE8pIbq%*n">
                <value name="IF0">
                  <block type="get_value" id="(@W9$u~,@r{y=g/]@]_}">
                    <field name="ATTR">val</field>
                    <field name="OID">javascript.0.Heizung_Schaltstufe_1</field>
                  </block>
                </value>
                <statement name="DO0">
                  <block type="comment" id=".df.4MqT_G=TH7O!{34I">
                    <field name="COMMENT">Phase 1,2 sind schon zugeschalten - 1. Stufe abschalten</field>
                    <next>
                      <block type="comment" id="oi%v*[vaFLk7xADEo9D7">
                        <field name="COMMENT">Zu wenig Leistung vorhanden -&gt; Phasenabschaltung alles Phasen</field>
                        <next>
                          <block type="update" id="HiXBva+0G]HA0/s1ePEk">
                            <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                            <field name="OID">javascript.0.Heizung_Schaltstufe_1</field>
                            <field name="WITH_DELAY">FALSE</field>
                            <value name="VALUE">
                              <block type="logic_boolean" id="`mm:%VPh$;-@(jp%FFVW">
                                <field name="BOOL">FALSE</field>
                              </block>
                            </value>
                            <next>
                              <block type="comment" id=";d8b=+]uDFbhtIg7^C-A">
                                <field name="COMMENT">Phase 1 &amp; 2 aus</field>
                                <next>
                                  <block type="control" id="OOm894PA0UG?PUs(gK##">
                                    <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                                    <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.command</field>
                                    <field name="WITH_DELAY">FALSE</field>
                                    <value name="VALUE">
                                      <block type="text" id="uub4g_--]/Jw@*+U!j2f">
                                        <field name="TEXT">L12 aus</field>
                                      </block>
                                    </value>
                                    <next>
                                      <block type="debug" id="@q4#X[YLypOe@FU$|mV7" disabled="true">
                                        <field name="Severity">info</field>
                                        <value name="TEXT">
                                          <shadow type="text" id="u0Xvy@V:1^F:N)1RCKec">
                                            <field name="TEXT">Phase 1 &amp; 2 abgeschaltet</field>
                                          </shadow>
                                        </value>
                                        <next>
                                          <block type="comment" id="5]4W{7Ycwgw2Ry^In+!S">
                                            <field name="COMMENT">Lüfter mit Zeitverzögerung aus</field>
                                            <next>
                                              <block type="timeouts_settimeout" id="O.cRn7x8[|@OnK/@^AlR">
                                                <field name="NAME">Lüfterabschaltung</field>
                                                <field name="DELAY">15</field>
                                                <field name="UNIT">sec</field>
                                                <statement name="STATEMENT">
                                                  <block type="control" id="$8pnxh]zE*GO6@A_wL~C">
                                                    <mutation xmlns="http://www.w3.org/1999/xhtml" delay_input="false"></mutation>
                                                    <field name="OID">mqtt.0.SmartHome.Keller.Heizung.ESP32_Heizstabsteuerung.command</field>
                                                    <field name="WITH_DELAY">FALSE</field>
                                                    <value name="VALUE">
                                                      <block type="text" id="/U4Gl*);5-3j8_=Pat/Z">
                                                        <field name="TEXT">Fan aus</field>
                                                      </block>
                                                    </value>
                                                  </block>
                                                </statement>
                                              </block>
                                            </next>
                                          </block>
                                        </next>
                                      </block>
                                    </next>
                                  </block>
                                </next>
                              </block>
                            </next>
                          </block>
                        </next>
                      </block>
                    </next>
                  </block>
                </statement>
              </block>
            </statement>
          </block>
        </next>
      </block>
    </statement>
  </block>
</xml>